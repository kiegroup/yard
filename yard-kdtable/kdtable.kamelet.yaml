apiVersion: camel.apache.org/v1alpha1
kind: Kamelet
metadata:
  name: kdtable
  annotations:
    camel.apache.org/kamelet.icon: "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgeG1sbnM6aT0iJmFtcDtuc19haTsiCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIGlua3NjYXBlOnZlcnNpb249IjEuMCAoNDAzNWE0ZiwgMjAyMC0wNS0wMSkiCiAgIHNvZGlwb2RpOmRvY25hbWU9ImRyb29sc19pY29uICgyKS5zdmciCiAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI1NiAyNTYiCiAgIHZpZXdCb3g9IjAgMCAyNTYgMjU2IgogICBoZWlnaHQ9IjI1NnB4IgogICB3aWR0aD0iMjU2cHgiCiAgIHk9IjBweCIKICAgeD0iMHB4IgogICBpZD0iTGF5ZXJfMSIKICAgdmVyc2lvbj0iMS4xIj48bWV0YWRhdGEKICAgaWQ9Im1ldGFkYXRhODUyIj48cmRmOlJERj48Y2M6V29yawogICAgICAgcmRmOmFib3V0PSIiPjxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PjxkYzp0eXBlCiAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+PGRjOnRpdGxlPjwvZGM6dGl0bGU+PC9jYzpXb3JrPjwvcmRmOlJERj48L21ldGFkYXRhPjxkZWZzCiAgIGlkPSJkZWZzODUwIiAvPjxzb2RpcG9kaTpuYW1lZHZpZXcKICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0iTGF5ZXJfMSIKICAgaW5rc2NhcGU6d2luZG93LW1heGltaXplZD0iMSIKICAgaW5rc2NhcGU6d2luZG93LXk9IjAiCiAgIGlua3NjYXBlOndpbmRvdy14PSIwIgogICBpbmtzY2FwZTpjeT0iMTI4IgogICBpbmtzY2FwZTpjeD0iMTI4IgogICBpbmtzY2FwZTp6b29tPSIyLjI0MjE4NzUiCiAgIHNob3dncmlkPSJmYWxzZSIKICAgaWQ9Im5hbWVkdmlldzg0OCIKICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iMTQxMiIKICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIyNTYwIgogICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMCIKICAgZ3VpZGV0b2xlcmFuY2U9IjEwIgogICBncmlkdG9sZXJhbmNlPSIxMCIKICAgb2JqZWN0dG9sZXJhbmNlPSIxMCIKICAgYm9yZGVyb3BhY2l0eT0iMSIKICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIgLz4KPHN3aXRjaAogICBpZD0ic3dpdGNoODQ1Ij4KCTxmb3JlaWduT2JqZWN0CiAgIGhlaWdodD0iMSIKICAgd2lkdGg9IjEiCiAgIHk9IjAiCiAgIHg9IjAiCiAgIHJlcXVpcmVkRXh0ZW5zaW9ucz0iaHR0cDovL25zLmFkb2JlLmNvbS9BZG9iZUlsbHVzdHJhdG9yLzEwLjAvIj4KCQkKCTwvZm9yZWlnbk9iamVjdD4KCTxnCiAgIGlkPSJnODQzIgogICBpOmV4dHJhbmVvdXM9InNlbGYiPgoJCTxnCiAgIGlkPSJnODQxIj4KCQkJPHBhdGgKICAgaWQ9InBhdGg4MzMiCiAgIGQ9Ik03MC45NTYsMTk1Ljc4MWMtMC40MDMsMC0wLjgxMS0wLjA1Mi0xLjIxOS0wLjE2Yy0yLjUwMi0wLjY3MS0zLjk5LTMuMjQ3LTMuMzE5LTUuNzUxICAgICBjNy43NTctMjguOTU5LDYuMjc0LTEwNi40MzYsNi4yNTctMTA3LjIxN2MtMC4wNTMtMi41ODksMi4wMDctNC43MzUsNC41OTktNC43ODVjMC4wMzMtMC4wMDMsMC4wNjUtMC4wMDMsMC4wOTYtMC4wMDMgICAgIGMyLjU0OSwwLDQuNjQsMi4wMzgsNC42OTIsNC42YzAuMDY2LDMuMjM1LDEuNTIzLDc5LjYwNC02LjU3NCwxMDkuODM4Qzc0LjkyNiwxOTQuMzk4LDczLjAyOCwxOTUuNzgxLDcwLjk1NiwxOTUuNzgxeiIKICAgZmlsbD0iIzAwOTVERCIgLz4KCQkJPHBhdGgKICAgaWQ9InBhdGg4MzUiCiAgIGQ9Ik0xMzguNjEzLDEzNy40MTZjLTkuNDQxLDAtMTcuMzkyLTMuODktMTcuOTA1LTQuMTQ5Yy0yLjMxOC0xLjE1OC0zLjI1OC0zLjk3OC0yLjA5OS02LjI5NSAgICAgYzEuMTU3LTIuMzEyLDMuOTY2LTMuMjU3LDYuMjkxLTIuMTA0YzAuMjc5LDAuMTM4LDE0Ljc3Nyw3LjA5MywyNC41MTktMC4xMDZjMi4wODMtMS41NDYsNS4wMjItMS4xMDMsNi41NjQsMC45ODIgICAgIGMxLjU0MiwyLjA4NCwxLjEwMSw1LjAyMi0wLjk4Myw2LjU2NEMxNDkuNzgsMTM2LjE2OCwxNDMuOTU4LDEzNy40MTYsMTM4LjYxMywxMzcuNDE2eiIKICAgZmlsbD0iIzc2NThCMSIgLz4KCQkJPHBhdGgKICAgaWQ9InBhdGg4MzciCiAgIGQ9Ik0xNTcuMjEsMTgyLjkyNmMtMy43NTEsMC03Ljk5Ny0wLjIyOS0xMi43NzMtMC41MmMtMi41ODgtMC4xNTktNC41NTctMi4zODYtNC4zOTktNC45NzYgICAgIGMwLjE1OC0yLjU4NywyLjM2NC00LjU0MSw0Ljk3Mi00LjM5N2M5LjgzOSwwLjYwNCwyMC45ODUsMS4yOTEsMjMuNjctMS45NzljMS45NTQtMi4zODQsMS41NDItOC45MTItMS4yMjgtMTkuNCAgICAgYy02Ljc5Ni0yNS43MzItMC44ODgtMzQuNDAyLDUuMTg1LTQwLjUwNWMwLjQyNS0wLjQyMywwLjgyLTAuODE3LDEuMTU5LTEuMjA3YzQuMTA1LTQuNjg1LDE3LjQwNy0xMS45MzcsMjAuMDMtMTMuMzQyICAgICBjMi4yODYtMS4yMjYsNS4xMzEtMC4zNjQsNi4zNTQsMS45MTljMS4yMjQsMi4yODYsMC4zNjUsNS4xMjktMS45MTksNi4zNTZjLTUuOTA1LDMuMTYzLTE1LjIwNyw4Ljc0Ny0xNy4zOTksMTEuMjQ4ICAgICBjLTAuNDU5LDAuNTI3LTAuOTkzLDEuMDY5LTEuNTY3LDEuNjQ3Yy0zLjQ4NywzLjUwNS04Ljc1OCw4LjgtMi43NjcsMzEuNDgzYzMuODM0LDE0LjUyNSwzLjY2NCwyMi41NjYtMC41OTEsMjcuNzUzICAgICBDMTcyLjExOCwxODEuNjY0LDE2Ni4wMjQsMTgyLjkyNiwxNTcuMjEsMTgyLjkyNnoiCiAgIGZpbGw9IiNGRjhBMTIiIC8+CgkJCTxwYXRoCiAgIGlkPSJwYXRoODM5IgogICBkPSJNMTQ3Ljg4MywyNTAuOTA0Yy0xMS41OTksMC0yMi45NzUtNS4xNzYtMzAuOTIzLTE0LjU0OWMtMTguNzAyLTIyLjA1OS0zMi4zNzYtMjEuODU0LTMyLjUzNS0yMS44NzMgICAgIGMtMi41OTEsMC4xNzQtNC43NTEtMS45LTQuODc4LTQuNDU2Yy0wLjEyOC0yLjU1NiwxLjc2OS00LjczOCw0LjMyLTQuOTE0YzEuODMyLTAuMTA3LDE4LjQ5OC0wLjQ4OSw0MC4yNTMsMjUuMTcxICAgICBjOC4yNTEsOS43MzEsMjAuNjYxLDEzLjU0MiwzMi4zODYsOS45NGMyMi44NDMtNy4wMTQsMzkuMDE2LTM5LjUyNyw0NC4zNjUtODkuMjAxYzQuNzI5LTQzLjkwMyw3LjUyOC04OC43OTMtMTQuMTgxLTExMi45NjIgICAgIGMtMTIuOTA4LTE0LjM3Ni0zMy45NDctMjEuMzYyLTY0LjMxNy0yMS4zNjJjLTY1LjIxNiwwLTc4LjY0NSw0Mi41MDMtODEuMzkxLDYwLjc3OGMtNC4xMzUsMjcuNTE4LDYuNDU5LDU2LjAyNCwyMi42NjgsNjEuMDA5ICAgICBjMi40NzgsMC43NjMsMy44NywzLjM4OSwzLjEwNyw1Ljg2OGMtMC43NjMsMi40NzYtMy4zODgsMy44NjEtNS44NjcsMy4xMDRjLTIwLjY4My02LjM1OS0zNC4wNTEtMzkuMDQ0LTI5LjE5My03MS4zNzYgICAgIEMzOC4xNywzMy4wMTgsNzIuMDY3LDcuMzA5LDEyMi4zNzQsNy4zMDljMzMuMTg4LDAsNTYuNTExLDguMDA4LDcxLjMwMywyNC40NzljMjQuMjg5LDI3LjA0NSwyMS40ODQsNzQuMjI5LDE2LjUyOSwxMjAuMjQgICAgIGMtNy45MDQsNzMuMzYtMzUuMzEyLDkyLjM2OC01MC45NDQsOTcuMTdDMTU1LjUyLDI1MC4zNDYsMTUxLjY5LDI1MC45MDQsMTQ3Ljg4MywyNTAuOTA0eiIKICAgZmlsbD0iI0RCMDAxMiIgLz4KCQk8L2c+Cgk8L2c+Cjwvc3dpdGNoPgoKPC9zdmc+Cg=="
    camel.apache.org/provider: "drools.org"
  labels:
    camel.apache.org/kamelet.type: "action"
spec:
  definition:
    title: "Kamelet decision table with YaRD"
    description: |-
      Experimental Kamelet processor supporting (only) YaRD's decision table.
    required:
    - kdtable
    properties:
      kdtable:
        title: kdtable
        description: the YaRD's decision table element
        type: object
      expressionLang:
        title: expressionLang
        description: can be blank
        type: string
      resultKey:
        title: resultKey
        description: can be blank
        type: string
        default: kdtable
  dependencies:
  - "camel:core"
  - "camel:kamelet"
  - "github:kiegroup.yard/yard-kdtable/camelk-SNAPSHOT" # advised by Camel-K team for multimodule projects such as YaRD. If updating snapshot, requires erase/delete the integration-kit and build on the cluster?
  template:
    beans:
      - name: mmbean
        type: '#class:org.drools.yard.kdtable.KdtableProcessor'
        properties:
          kdtable: '{{kdtable}}'
          expressionLang: '{{?expressionLang}}'
          resultKey: '{{resultKey}}'
    from:
      uri: "kamelet:source"
      steps:
      - process:
          ref: '{{mmbean}}'
      - to: "log:info"
      - to: "kamelet:sink"
